{% load static %}
{% load crispy_forms_tags %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Beaker">
    <link rel="icon" href="../../favicon.ico">
    <title>{% block head_title %}Online Grocer{% endblock %}</title>
    {% block head_extra %} {% endblock head_extra %}
    {% include 'head_css.html' %}
      <style>
      {% block style %}{% endblock %}

      .input-group>.input-group-prepend {
          flex: 0 0 30%;
      }
      .input-group>.input-group-append {
          flex: 0 0 30%;
      }      
      .input-group .input-group-text {
          width: 100%;
      }
      </style>
  </head>
  <body>
  {% include 'base/navbar.html' %}
  {% include 'base/subbar.html' %}
  {% include 'base/pickupbar.html' %}
  {% if messages %}
  <div class='container'>
    <div class='alert alert-success text-center alert-dismissible'>
     <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
    {% for message in messages %}
      <p{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</p><br/>
    {% endfor %}
    </div>
  </div>
  {% endif %}
    {% block jumbotron %}        
    {% endblock %}
    <div class="container">    
      {% block content %}
      {% endblock %}
    </div> <!-- /container -->
    {% include "filter-modal.html" %}
    {% include "javascript.html" %}
    {% block javascript %}
    {% endblock %}
    <script>
    $(document).ready(function(){
        {% block jquery %}
        {% endblock %}
    });
    </script>
<script type="text/javascript">
  jQuery.browser = {};
  (function () {
      jQuery.browser.msie = false;
      jQuery.browser.version = 0;
      if (navigator.userAgent.match(/MSIE ([0-9]+)\./)) {
          jQuery.browser.msie = true;
          jQuery.browser.version = RegExp.$1;
      }
  })();
  $(function() {
      var startDate;
      var endDate;
      
      var selectCurrentWeek = function() {
          window.setTimeout(function () {
              $('.week-picker').find('.ui-datepicker-current-day a').addClass('ui-state-active')
          }, 1);
      }
      $('.week-picker').datepicker( {
          showOtherMonths: true,
          selectOtherMonths: true,
          onSelect: function(dateText, inst) { 
              var date = $(this).datepicker('getDate');
              startDate = new Date(date.getFullYear(), date.getMonth(), date.getDate() - date.getDay());
              endDate = new Date(date.getFullYear(), date.getMonth(), date.getDate() - date.getDay() + 6);
              savedDate = new Date(date.getFullYear(), date.getMonth(), date.getDate() - date.getDay() + 2); // add logic to saved true delivery start date
              var dateFormat = inst.settings.dateFormat || $.datepicker._defaults.dateFormat;
              $('#startDate').text($.datepicker.formatDate( dateFormat, startDate, inst.settings ));
              $('#endDate').text($.datepicker.formatDate( dateFormat, endDate, inst.settings ));
              // $('#id_delivery_start').text($.datepicker.formatDate( dateFormat, startDate, inst.settings ));
              // $('#id_delivery_start').val($.datepicker.formatDate('yy-mm-dd 00:00', startDate));
              $('#id_delivery_start').text($.datepicker.formatDate( dateFormat, savedDate, inst.settings ));
              $('#id_delivery_start').val($.datepicker.formatDate('yy-mm-dd 00:00', savedDate));
              console.log(savedDate);
              
              selectCurrentWeek();
          },
          beforeShowDay: function(date) {
              var cssClass = '';
              if(date >= startDate && date <= endDate)
                  cssClass = 'ui-datepicker-current-day';
              return [true, cssClass];
          },
          onChangeMonthYear: function(year, month, inst) {
              selectCurrentWeek();
          }
      });
      
      // $('.week-picker .ui-datepicker-calendar tr').live('mousemove', function() { $(this).find('td a').addClass('ui-state-hover'); });
      // $('.week-picker .ui-datepicker-calendar tr').live('mouseleave', function() { $(this).find('td a').removeClass('ui-state-hover'); });
      $(document).on( 'mousemove','.week-picker .ui-datepicker-calendar tr',function() {$(this).find('td a').addClass('ui-state-hover'); }); 
      $(document).on('mouseleave','.week-picker .ui-datepicker-calendar tr',function() {$(this).find('td a').removeClass('ui-state-hover'); });
  });
  </script>
  </body>
  <footer>
    <div class='container'>
        <hr/><br/>
        <div class="row">
          <div class='col-sm-4 text-center hide-on-mobile'>
              <p class='legal-sm'><strong><em>Contact</em></strong><br/>
                555 413-6543<br/>
                123 N. Main St.<br/>
                Fargo, Nd. 33342<br/>
                support@beaker.life
              </p>
          </div>
          <div class="col-sm-4 text-center">
            <p><span class='orange-txt'><i class="fas fa-carrot"></i></span> eGrocerÂ® &copy; 2020 <br/><br/> All rights reserved.<br/><a class='btn btn-link legal-sm' href='#'>privacy</a></p>
            <p>Payments powered by <br/><span class="pp-size-lg"><i class="fab fa-cc-paypal"></i></span></p>
            <br/>
          </div>
          <div class="col-sm-4 text-center hide-on-mobile">
            <p class='legal-sm'><strong><em>Hours</em></strong><br/>
              Mon - Closed<br/>
              Tues - Thurs 4pm-11pm<br/>
              Fri - 4pm-12am<br/>
              Sat - 11:30am-12am<br/>
              Sun - 11:30am-9pm
            </p>
          </div>

        </div>
    </div>
  </footer>
</html>